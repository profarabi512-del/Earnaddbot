
<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Earn Ads - Simple Demo</title>
  <style>
    :root{
      --bg:#f4f6fb;
      --card:#ffffff;
      --primary:#0b76ff;
      --accent:#00b894;
      --muted:#6b7280;
      --danger:#ff7043;
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
    }
    body{
      margin:0;
      background:linear-gradient(180deg,var(--bg),#e9eef8);
      min-height:100vh;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:20px;
    }
    .phone {
      width:360px;
      max-width:95%;
      background:var(--card);
      border-radius:18px;
      box-shadow:0 8px 30px rgba(15,23,42,0.12);
      overflow:hidden;
      border:1px solid rgba(0,0,0,0.04);
    }
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:14px 16px;
      background:linear-gradient(90deg,var(--primary),#2aa6ff);
      color:white;
    }
    header h1{font-size:16px;margin:0}
    .content{padding:16px}
    .card{
      background:var(--card);
      border-radius:12px;
      padding:12px;
      box-shadow: 0 4px 14px rgba(12,30,60,0.04);
      margin-bottom:12px;
      border:1px solid rgba(0,0,0,0.02)
    }
    .balance{
      display:flex;
      align-items:center;
      justify-content:space-between;
    }
    .balance .left{font-size:14px;color:var(--muted)}
    .balance .right{font-size:22px;font-weight:700;color:#0b3b80}
    .btn{
      display:inline-block;
      background:var(--primary);
      color:white;
      padding:10px 14px;
      border-radius:10px;
      text-decoration:none;
      cursor:pointer;
      border:none;
      font-weight:600;
      box-shadow:0 6px 18px rgba(11,118,255,0.18);
    }
    .btn.secondary{
      background:#eef6ff;color:var(--primary);box-shadow:none;border:1px solid rgba(11,118,255,0.08);
    }
    .muted{color:var(--muted);font-size:13px}
    .ads-list{display:flex;gap:8px;flex-direction:column}
    .ad-item{display:flex;align-items:center;gap:12px;padding:10px;border-radius:10px;background:linear-gradient(180deg,#ffffff,#fbfcff);border:1px solid rgba(0,0,0,0.02)}
    .ad-thumb{width:64px;height:44px;border-radius:8px;background:linear-gradient(90deg,#ffd54f,#ff7043);display:flex;align-items:center;justify-content:center;color:white;font-weight:800}
    .ad-info{flex:1}
    .ad-title{font-weight:700;font-size:14px}
    .ad-desc{font-size:12px;color:var(--muted)}
    footer{
      padding:12px 16px 18px;
      background:#fff;
      border-top:1px solid rgba(0,0,0,0.03);
      display:flex;
      gap:8px;
      justify-content:space-between;
      align-items:center;
    }
    .small{font-size:12px;color:var(--muted)}
    .toast{
      position:fixed;
      right:18px;
      bottom:22px;
      background:#222;
      color:white;
      padding:10px 14px;
      border-radius:10px;
      box-shadow:0 6px 18px rgba(0,0,0,0.25);
      opacity:0;transform:translateY(12px);
      transition:all .28s ease;
      z-index:9999;
    }
    .toast.show{opacity:1;transform:translateY(0)}
    .info-row{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-top:8px}
    .withdraw-form input{padding:8px;border-radius:8px;border:1px solid #e6eef8;width:100%}
    @media (max-width:420px){
      .phone{width:92%}
    }
  </style>
</head>
<body>
  <div class="phone" role="main" aria-label="Earn Ads Demo">
    <header>
      <h1>EarnAds Demo</h1>
      <div class="small">Welcome, User</div>
    </header>

    <div class="content">
      <div class="card">
        <div class="balance">
          <div>
            <div class="muted">আপনার ব্যালান্স</div>
            <div id="balanceVal" class="right">৳0</div>
          </div>
          <div style="text-align:right">
            <div class="muted">Ads watched</div>
            <div id="adsCount" style="font-weight:700">0</div>
          </div>
        </div>

        <div style="margin-top:12px" class="info-row">
          <button id="openAdBtn" class="btn">Add Income / Earn</button>
          <button id="referBtn" class="btn secondary">Refer & Earn</button>
        </div>

        <div style="margin-top:10px" class="muted">
          প্রতি অ্যাড ক্লোজ করলে আয়: <strong>৳1</strong> । মিনিমাম উইথড্র: <strong>৳1000</strong>
        </div>
      </div>

      <div class="card">
        <div style="display:flex;align-items:center;justify-content:space-between">
          <div>
            <div class="ad-title">Available Ads</div>
            <div class="muted">Click "Add Income / Earn" to open ad link</div>
          </div>
          <div class="small muted">Live</div>
        </div>

        <div class="ads-list" style="margin-top:10px">
          <div class="ad-item">
            <div class="ad-thumb">AD</div>
            <div class="ad-info">
              <div class="ad-title">Promoted Offer</div>
              <div class="ad-desc">Watch/visit the ad and close -> +৳1</div>
            </div>
            <div>
              <button class="btn secondary" onclick="openAd()">Open</button>
            </div>
          </div>
          <!-- Add more ad items if wanted -->
        </div>
      </div>

      <div class="card">
        <div style="display:flex;align-items:center;justify-content:space-between">
          <div>
            <div class="ad-title">Withdraw</div>
            <div class="muted">Minimum withdraw: ৳1000</div>
          </div>
          <div class="muted">Methods: Bank / bkash (demo)</div>
        </div>

        <div style="margin-top:10px" class="withdraw-form">
          <input id="withdrawAmount" type="number" placeholder="টাকা (৳) লিখুন"/>
          <div style="margin-top:8px;display:flex;gap:8px">
            <button id="withdrawBtn" class="btn">Withdraw</button>
            <button id="historyBtn" class="btn secondary">History</button>
          </div>
        </div>
      </div>

    </div>

    <footer>
      <div class="small">Demo site - not real money</div>
      <div>
        <button id="resetBtn" class="btn secondary">Reset</button>
      </div>
    </footer>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

<script>
(function(){
  const AD_URL = "https://otieu.com/4/10086963";
  const EARN_PER_AD = 1; // ৳1 per ad
  const MIN_WITHDRAW = 1000; // ৳1000

  const balanceKey = "earn_demo_balance_v1";
  const adsKey = "earn_demo_ads_v1";
  const historyKey = "earn_demo_history_v1";

  let popup = null;
  let popupCheckInterval = null;
  let lastOpenStamp = 0;

  // DOM
  const balanceVal = document.getElementById("balanceVal");
  const adsCountDom = document.getElementById("adsCount");
  const openAdBtn = document.getElementById("openAdBtn");
  const withdrawBtn = document.getElementById("withdrawBtn");
  const withdrawAmount = document.getElementById("withdrawAmount");
  const resetBtn = document.getElementById("resetBtn");
  const toastEl = document.getElementById("toast");
  const referBtn = document.getElementById("referBtn");
  const historyBtn = document.getElementById("historyBtn");

  // helpers
  function showToast(msg, time=2400){
    toastEl.textContent = msg;
    toastEl.classList.add("show");
    clearTimeout(toastEl._t);
    toastEl._t = setTimeout(()=>toastEl.classList.remove("show"), time);
  }

  function formatMoney(n){ return "৳" + Number(n).toFixed(0); }

  function getBalance(){ return Number(localStorage.getItem(balanceKey) || 0); }
  function getAdsCount(){ return Number(localStorage.getItem(adsKey) || 0); }
  function getHistory(){ try{ return JSON.parse(localStorage.getItem(historyKey) || "[]"); }catch(e){ return []; } }

  function setBalance(v){ localStorage.setItem(balanceKey, String(Math.max(0, Math.round(v)))); render(); }
  function addBalance(v){
    const prev = getBalance();
    setBalance(prev + Number(v));
    addHistory({ type:"earn", amount: Number(v), at: Date.now() });
  }
  function incrementAds(n=1){
    const prev = getAdsCount();
    localStorage.setItem(adsKey, String(prev + n));
    render();
  }
  function addHistory(item){
    const list = getHistory();
    list.unshift(item);
    localStorage.setItem(historyKey, JSON.stringify(list.slice(0,200)));
  }

  function render(){
    balanceVal.textContent = formatMoney(getBalance());
    adsCountDom.textContent = getAdsCount();
  }

  // open ad in popup and watch for close
  function openAdWindow(){
    // prevent too frequent opens
    const now = Date.now();
    if(now - lastOpenStamp < 1500){
      showToast("Please wait a moment before opening another ad");
      return;
    }
    lastOpenStamp = now;

    // open popup centered
    const w = 380, h = Math.min(screen.height - 100, 780);
    const left = (screen.width/2) - (w/2);
    const top = (screen.height/2) - (h/2);
    popup = window.open(AD_URL, "_blank", `width=${w},height=${h},left=${left},top=${top},resizable=yes`);
    if(!popup){
      // popup blocked -> fallback to same tab
      showToast("Popup blocked. Opening link in this tab.");
      window.location.href = AD_URL;
      return;
    }
    showToast("Ad opened. Close the tab/window after viewing to get ৳1.");

    // start interval to check if closed
    if(popupCheckInterval) clearInterval(popupCheckInterval);
    popupCheckInterval = setInterval(()=>{
      try {
        if(!popup || popup.closed){
          clearInterval(popupCheckInterval);
          popupCheckInterval = null;
          popup = null;

          // credit user
          addBalance(EARN_PER_AD);
          incrementAds(1);
          showToast("অভিনন্দন — আপনি পেয়েছেন ৳" + EARN_PER_AD);
        }
      } catch(e){
        // cross-origin access may throw, ignore and continue
      }
    }, 800);
  }

  // Buttons
  openAdBtn.addEventListener("click", openAdWindow);
  // also allow small ad open
  window.openAd = openAdWindow;

  referBtn.addEventListener("click", ()=>{
    const ref = "https://otieu.com/4/10086963";
    navigator.clipboard?.writeText(ref).then(()=>{
      showToast("Referral link copied to clipboard");
    }).catch(()=>{
      prompt("Copy this referral link:", ref);
    });
  });

  withdrawBtn.addEventListener("click", ()=>{
    const wanted = Number(withdrawAmount.value || 0);
    const current = getBalance();
    if(isNaN(wanted) || wanted <= 0){
      showToast("ঠিক পরিমাণ লিখুন");
      return;
    }
    if(wanted > current){
      showToast("আপনার ব্যালান্স পর্যাপ্ত নয়");
      return;
    }
    if(wanted < MIN_WITHDRAW){
      showToast("সর্বনিম্ন উইথড্র হলো ৳" + MIN_WITHDRAW);
      return;
    }

    // simulate withdraw flow
    const method = prompt("Withdrawal method লিখুন (উদাহরণ: bkash / bank):", "bkash");
    if(!method) { showToast("Withdraw cancelled"); return; }
    const acc = prompt("Account / নম্বর লিখুন:");
    if(!acc){ showToast("Withdraw cancelled"); return; }

    // process: deduct balance and add history
    setBalance(current - wanted);
    addHistory({ type:"withdraw", amount: Number(wanted), method, account: acc, at: Date.now() });
    showToast("Withdraw request submitted: ৳" + wanted);
    withdrawAmount.value = "";
  });

  historyBtn.addEventListener("click", ()=>{
    const h = getHistory();
    if(h.length === 0){
      showToast("কোনো লেনদেন নেই");
      return;
    }
    // build a short textual history and show in new window
    let txt = "History (latest 20):\n\n";
    for(let i=0;i<Math.min(20,h.length);i++){
      const it = h[i];
      const d = new Date(it.at).toLocaleString();
      if(it.type === "earn") txt += `${d}: Earned ৳${it.amount}\n`;
      else if(it.type === "withdraw") txt += `${d}: Withdraw ৳${it.amount} (${it.method} / ${it.account})\n`;
      else txt += `${d}: ${JSON.stringify(it)}\n`;
    }
    const w = window.open("", "_blank", "width=420,height=640");
    w.document.write("<pre style='font-family:monospace;padding:16px;'>" + txt.replace(/</g,"&lt;") + "</pre>");
  });

  resetBtn.addEventListener("click", ()=>{
    if(confirm("Reset demo data?")) {
      localStorage.removeItem(balanceKey);
      localStorage.removeItem(adsKey);
      localStorage.removeItem(historyKey);
      render();
      showToast("Reset complete");
    }
  });

  // initial render
  render();

  // accessibility: if page becomes visible and popup closed in background without detection,
  // try to credit once if lastOpenStamp was recent and no popup exists.
  document.addEventListener("visibilitychange", ()=>{
    if(document.visibilityState === "visible"){
      // if popup check isn't running but last open was recent, try to credit once
      if(!popup && lastOpenStamp && Date.now() - lastOpenStamp < 1200*30){
        // very simple safety: do nothing automatic except render state. We rely on popup detection.
      }
    }
  });

  // when user closes main tab while popup open, popup keeps; it's fine.

})();
</script>
</body>
</html>







